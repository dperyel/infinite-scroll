(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,,function(t,e,n){t.exports=n(24)},,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},,function(t,e,n){"use strict";n.r(e);var a,i=n(0),r=n.n(i),u=n(9),o=n.n(u),s=(n(18),n(2)),c=(n(19),n(20),function(t){var e=t.info.images.preview,n={height:"".concat(e.height,"px"),width:"".concat(e.width,"px"),backgroundImage:"url(".concat(e.url,")")};return r.a.createElement("div",{className:"Image",style:n})}),h=n(1),l=n(3),f=n(5),d=n(4),v=n(6);!function(t){t.CorruptedList="Tail stays either out of the list or left to head"}(a||(a={}));var p,g=function(){function t(){Object(h.a)(this,t),this.head=void 0,this.tail=void 0,this.head=null,this.tail=null}return Object(l.a)(t,[{key:"setHead",value:function(t){return this.head=t,this}},{key:"getHead",value:function(){return this.head}},{key:"setTail",value:function(t){return this.tail=t,this}},{key:"getTail",value:function(){return this.tail}},{key:"mapToArray",value:function(t){var e=[];if(!this.head)return e;if(this.tail&&this.head===this.tail.getNext())throw new Error(a.CorruptedList);for(var n=this.head,i=this.tail?this.tail.getNext():null;n!==i;){if(!n)throw new Error(a.CorruptedList);var r=t(n.getValue());e.push(r),n=n.getNext()}return e}},{key:"toString",value:function(t){var e=t||function(t){return JSON.stringify(t)};return this.mapToArray(e).join(" -> ")}}]),t}();!function(t){t.SameTail="Head and tail cannot be the same refferences",t.NoHead="Head node cannot be empty"}(p||(p={}));var m=function(t){function e(){return Object(h.a)(this,e),Object(f.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(v.a)(e,t),Object(l.a)(e,[{key:"shiftList",value:function(t){var n=this.head&&t(this.head),a=this.tail&&t(this.tail);return n&&a?(new e).setHead(n).setTail(a):this}},{key:"validateList",value:function(){if(!this.head)throw new Error(p.NoHead);if(this.head===this.tail)throw new Error(p.SameTail)}}]),e}(g),b=function(t){return t.getNext()},w=function(t){return t.getPrevious()},y={paddingTop:0,paddingBottom:0};function j(t){return t?Number(t.getValue().images.preview.height):0}var O=function(t){var e=t.imageList,n=t.approachingBottomNotifier,a=r.a.createRef(),u=function(t,e,n){var a=Object(i.useState)(new m),r=Object(s.a)(a,2),u=r[0],o=r[1],c=Object(i.useState)(y),h=Object(s.a)(c,2),l=h[0],f=h[1];return Object(i.useEffect)(function(){for(var e=t.getHead(),n=0,a=0;a<20&&e.getValue();a++)n+=j(e),e=e.getNext();var i=t.mapToArray(function(t){return Number(t.images.preview.height)}).reduce(function(t,e){return t+e},0);f({paddingTop:0,paddingBottom:i-n});var r=(new m).setHead(t.getHead()).setTail(e);o(r)},[t]),Object(i.useEffect)(function(){var t=function(){if(e.current){var t=e.current.getBoundingClientRect(),a=window.innerHeight;if(t.bottom-a<1e3){var i=u.shiftList(b);if(i===u)return;o(i);var r=j(u.getHead()),s=j(i.getTail()),c=l.paddingBottom-s,h=l.paddingTop+r;c<1e3&&n&&(n(),c+=1e4),f({paddingBottom:c,paddingTop:h})}else if(t.top+1e3-100>=0){var d=u.shiftList(w);if(d===u)return;o(d);var v=j(d.getHead()),p=j(u.getTail()),g=l.paddingBottom+p,m=l.paddingTop-v;f({paddingBottom:g,paddingTop:m})}}};return window.addEventListener("scroll",t,!1),function(){window.removeEventListener("scroll",t,!1)}}),{visibleList:u,imageTapeStyle:l}}(e,a,n),o=u.visibleList,h=u.imageTapeStyle;return r.a.createElement(i.Fragment,null,r.a.createElement("div",{style:h},r.a.createElement("div",{ref:a},o.mapToArray(function(t){return r.a.createElement(c,{key:t.id,info:t})}))),r.a.createElement("p",null,"Loading..."))},E=(n(21),function(t){return r.a.createElement("div",{className:"Tape"},0===t.imageList.getSize()?r.a.createElement("p",null,"Loading..."):r.a.createElement(O,t))}),k=(n(22),function(t){var e=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=Object(i.useState)(""),a=Object(s.a)(n,2),r=a[0],u=a[1];return Object(i.useEffect)(function(){if(r){var n=setTimeout(function(){t(r)},e);return function(){clearTimeout(n)}}}),u}(t.onQueryChange,t.debounce);return r.a.createElement("div",{className:"SearchForm"},r.a.createElement("div",{className:"SearchForm-inputWrapper"},r.a.createElement("input",{className:"SearchForm-input",placeholder:"Search for: kittens",type:"text",onChange:function(t){var n=t.target.value.trim();e(n)}})))}),x=function(t){function e(){var t,n;Object(h.a)(this,e);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(f.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(i)))).size=0,n}return Object(v.a)(e,t),Object(l.a)(e,[{key:"setSize",value:function(t){return this.size=t,this}},{key:"getSize",value:function(){return this.size}},{key:"add",value:function(t){if(this.head)if(this.tail){var e=this.tail;e.setNext(t),this.tail=t,this.tail.setPrev(e)}else this.tail=t,this.tail.setPrev(this.head),this.head.setNext(this.tail);else this.head=t;return this.size+=1,this}}]),e}(g),N=function(t){function e(){return Object(h.a)(this,e),Object(f.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(v.a)(e,t),e}(function(){function t(e){Object(h.a)(this,t),this.value=void 0,this.next=null,this.prev=null,this.value=e}return Object(l.a)(t,[{key:"getValue",value:function(){return this.value}},{key:"setNext",value:function(t){return this.next=t,this}},{key:"getNext",value:function(){return this.next}},{key:"setPrev",value:function(t){return this.prev=t,this}},{key:"getPrevious",value:function(){return this.prev}},{key:"toString",value:function(t){var e=t||JSON.stringify,n=this.prev?e(this.prev.getValue()):"null",a=this.next?e(this.next.getValue()):"null",i=e(this.value);return"".concat(n," <- ").concat(i," -> ").concat(a)}}]),t}());var S=n(11),T=n(7),L=n.n(T),A=n(10);function H(t,e){var n=e&&Object.keys(e).map(function(t){var n=e[t].toString().trim();return"".concat(t,"=").concat(n)}).join("&"),a=t.trim(),i=n?"?".concat(n):"";return encodeURI(a+i)}var B=function(){function t(e){Object(h.a)(this,t),this.apiKey=void 0,this.apiKey=e}return Object(l.a)(t,[{key:"search",value:function(){var t=Object(A.a)(L.a.mark(function t(e,n){var a,i,r,u,o=arguments;return L.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=o.length>2&&void 0!==o[2]?o[2]:0,i=H("https://api.giphy.com/v1/gifs/search",{api_key:this.apiKey,q:e,limit:100,offset:a,rating:"G",lang:"en"}),t.prev=2,t.next=5,fetch(i,{signal:n});case 5:return r=t.sent,t.next=8,r.json();case 8:if(200!==(u=t.sent).meta.status){t.next=13;break}return t.abrupt("return",this.responseAdaptor(u));case 13:throw new Error("Status of the message is ".concat(u.meta.status));case 14:t.next=19;break;case 16:throw t.prev=16,t.t0=t.catch(2),new Error("Request was aborted");case 19:case"end":return t.stop()}},t,this,[[2,16]])}));return function(e,n){return t.apply(this,arguments)}}()},{key:"responseAdaptor",value:function(t){return{data:t.data.map(function(t){return{id:t.id,title:t.title,images:{preview:{height:t.images.fixed_width_downsampled.height,url:t.images.fixed_width_downsampled.url,width:t.images.fixed_width_downsampled.width}}}}),meta:{status:t.meta.status},pagination:Object(S.a)({},t.pagination)}}}]),t}(),C=function(){var t,e,n=Object(i.useState)("kittens"),a=Object(s.a)(n,2),u=a[0],o=a[1],c=new B("VR8zLh7EW0IgB3AethVFn2iseXA94K6i"),h=(t=E,e=c,function(n){var a=n.query,u=Object(i.useState)(new x),o=Object(s.a)(u,2),c=o[0],h=o[1],l=Object(i.useState)(!1),f=Object(s.a)(l,2),d=f[0],v=f[1],p=Object(i.useState)(),g=Object(s.a)(p,2),m=g[0],b=g[1];return Object(i.useEffect)(function(){var t=new AbortController;return e.search(a,t.signal).then(function(t){var e=t.data,n=t.pagination;b(n);for(var a=new x,i=0;i<e.length;i++){var r=e[i],u=new N(r);a.add(u)}h(a)}),function(){t.abort()}},[a]),Object(i.useEffect)(function(){if(d){var t=new AbortController,n=m.offset+m.count;return e.search(a,t.signal,n).then(function(t){var e=t.data,n=t.pagination;v(!1),b(n);for(var a=0;a<e.length;a++){var i=e[a],r=new N(i);c.add(r)}}),function(){t.abort()}}}),r.a.createElement(t,{imageList:c,approachingBottomNotifier:function(){d||v(!0)}})});return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(k,{onQueryChange:o}),r.a.createElement(h,{query:u})))};o.a.render(r.a.createElement(C,null),document.getElementById("root"))}],[[12,1,2]]]);
//# sourceMappingURL=main.8517feef.chunk.js.map